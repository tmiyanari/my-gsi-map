<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <title>クリック マイ地理院地図</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
    <link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css" rel="stylesheet" />
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
    </style>
</head>
<body>
    <div id="map"></div>
    <script>
       const map = new maplibregl.Map({
    container: 'map',
    style: {
        version: 8,
        sources: {
            // 地理院地図のタイルソースを定義
            'gsi-tiles': {
                type: 'raster',
                tiles: ['https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png'],
                tileSize: 256,
                attribution: "海域部は海上保安庁海洋情報部の資料を使用して作成"
            }
        },
        layers: [
            {
                id: 'gsi-layer',
                type: 'raster',
                source: 'gsi-tiles',
                minzoom: 0,
                maxzoom: 18
            }
        ]
    },
    center: [139.767, 35.681],
    zoom: 12
});

// データ（丸）の読み込みは先ほどと同じ
map.on('load', () => {
    map.addSource('my-cloud-data', {
        type: 'geojson',
        data: './mydata.geojson' 
    });
    map.addLayer({
        id: 'points',
        type: 'circle',
        source: 'my-cloud-data',
        paint: {
            'circle-radius': 10,
            'circle-color': '#FF4500',
            'circle-stroke-width': 2,
            'circle-stroke-color': '#ffffff'
        }
    });
});
        // ピンをクリックした時の処理
map.on('click', 'points', (e) => {
    // クリックされた地点の座標とプロパティを取得
    const coordinates = e.features[0].geometry.coordinates.slice();
    const name = e.features[0].properties.name;

    // ポップアップを表示
    new maplibregl.Popup()
        .setLngLat(coordinates)
        .setHTML(`<strong>地点名:</strong> ${name}`) // HTMLで中身を書ける
        .addTo(map);
});

// マウスが乗った時にカーソルを指の形にする（おもてなし）
map.on('mouseenter', 'points', () => {
    map.getCanvas().style.cursor = 'pointer';
});
map.on('mouseleave', 'points', () => {
    map.getCanvas().style.cursor = '';
});
    </script>
</body>
</html>
